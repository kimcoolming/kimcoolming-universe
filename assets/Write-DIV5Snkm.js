import{o as y,s as C,a as m,j as A,c as R,f as j,k as q}from"./firebase-ep8JVcOc.js";import{i as c,j as B,c as I,w as o,r as t,d as L,o as N,b as a,g as d}from"./index-Cqf29U-D.js";const W={__name:"Write",setup(P){const _=L(),r=c(""),l=c(""),s=c(null);B(()=>{y(m,async n=>{if(n)s.value=n;else try{const e=await C(m,"test@test.com","123456");s.value=e.user}catch(e){console.error("자동 로그인 실패:",e),alert("로그인 시도가 너무 많아 일시적으로 차단되었습니다. 나중에 다시 시도해주세요.")}})});const v=async()=>{if(!r.value.trim()||!l.value.trim()){alert("닉네임과 내용을 모두 입력해주세요.");return}if(!s.value){alert("로그인이 아직 완료되지 않았습니다. 잠시 후 다시 시도해주세요.");return}try{await A(R(j,"posts"),{nickname:r.value,message:l.value,userId:s.value.uid,createdAt:q()}),alert("방명록이 등록되었습니다!"),_.push("/guest-board")}catch(n){console.error("Firestore 저장 실패:",n),alert("글 작성에 실패했습니다.")}};return(n,e)=>{const i=t("v-btn"),p=t("RouterLink"),f=t("v-card-title"),x=t("v-text-field"),b=t("v-textarea"),w=t("v-card-text"),k=t("v-card-actions"),g=t("v-card"),V=t("v-container");return N(),I(V,{class:"py-8","max-width":"700"},{default:o(()=>[a(p,{to:"/guest-board"},{default:o(()=>[a(i,{"prepend-icon":"mdi-arrow-left",class:"mb-4",variant:"text"},{default:o(()=>e[2]||(e[2]=[d(" 방명록으로 ")])),_:1})]),_:1}),a(g,null,{default:o(()=>[a(f,null,{default:o(()=>e[3]||(e[3]=[d("✍ 방명록 남기기")])),_:1}),a(w,null,{default:o(()=>[a(x,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=u=>r.value=u),label:"닉네임",outlined:"",required:"",dense:"",class:"mb-4"},null,8,["modelValue"]),a(b,{modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=u=>l.value=u),label:"내용",rows:"6",outlined:"","auto-grow":"",required:""},null,8,["modelValue"])]),_:1}),a(k,null,{default:o(()=>[a(i,{color:"primary",block:"",onClick:v},{default:o(()=>e[4]||(e[4]=[d(" ✅ 등록하기 ")])),_:1})]),_:1})]),_:1})]),_:1})}}};export{W as default};
