import{i as r,j as G,c as _,w as o,r as a,o as c,b as u,k as D,a as d,e as $,g as m,t as f,F as H,f as W,l as Y}from"./index-BaJXCc7g.js";import{s as z,o as J,a as A,g as K,c as w,q as B,l as M,b as O,d as V,e as Q,f as g,h as U,i as X}from"./firebase-ep8JVcOc.js";const Z={class:"mb-4 text-medium-emphasis"},ee={class:"d-flex justify-space-between align-center"},te={class:"text-grey"},oe={class:"mt-2"},ae={key:2,class:"text-center text-grey mt-4"},C=5,ce={__name:"GuestBoard",setup(ne){const i=r([]),p=r(null),v=r(!1),y=r(!1),h=r(0),x=r(1),k=r(null);G(()=>{z(A,"test@test.com","123456").catch(console.error),J(A,t=>{k.value=t,F(),S()})});const F=async()=>{const t=await K(w(g,"posts"));h.value=t.data().count},S=async()=>{if(v.value||y.value)return;v.value=!0;const t=p.value?B(w(g,"posts"),V("createdAt","desc"),O(p.value),M(C)):B(w(g,"posts"),V("createdAt","desc"),M(C)),e=await Q(t),s=e.docs.map(n=>({id:n.id,...n.data()}));i.value.push(...s),e.docs.length<C&&(y.value=!0),e.docs.length>0&&(p.value=e.docs[e.docs.length-1]),x.value++,v.value=!1},L=t=>{if(!(t!=null&&t.toDate))return"";const e=t.toDate();return`${e.getFullYear()}.${String(e.getMonth()+1).padStart(2,"0")}.${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`},N=async t=>{var s;if(((s=k.value)==null?void 0:s.uid)!==t.userId){alert("Î≥∏Ïù∏Îßå ÏÇ≠Ï†úÌï† Ïàò ÏûàÏñ¥Ïöî.");return}confirm("Ï†ïÎßê ÏÇ≠Ï†úÌï†ÍπåÏöî?")&&(await U(X(g,"posts",t.id)),i.value=i.value.filter(n=>n.id!==t.id),h.value--)};return(t,e)=>{const s=a("v-col"),n=a("v-btn"),P=a("RouterLink"),j=a("v-row"),q=a("v-alert"),I=a("v-icon"),E=a("v-card-text"),R=a("v-card"),T=a("v-container");return c(),_(T,{class:"py-8","max-width":"700"},{default:o(()=>[u(j,{justify:"space-between",align:"center",class:"mb-4"},{default:o(()=>[u(s,null,{default:o(()=>e[0]||(e[0]=[d("h2",null,"üìñ Î∞©Î™ÖÎ°ù",-1)])),_:1}),u(s,{cols:"auto"},{default:o(()=>[u(P,{to:"/guest-board/write"},{default:o(()=>[u(n,{color:"primary","prepend-icon":"mdi-pencil"},{default:o(()=>e[1]||(e[1]=[m("Í∏ÄÏì∞Í∏∞")])),_:1})]),_:1})]),_:1})]),_:1}),i.value.length===0&&!v.value?(c(),_(q,{key:0,type:"info",class:"mb-4"},{default:o(()=>e[2]||(e[2]=[m(" ÏïÑÏßÅ Îì±Î°ùÎêú Í∏ÄÏù¥ ÏóÜÏäµÎãàÎã§. ")])),_:1})):D("",!0),d("p",Z,"Ï†ÑÏ≤¥ "+f(h.value)+"Í∞úÏùò Í∏ÄÏù¥ ÏûàÏäµÎãàÎã§. ("+f(x.value-1)+" ÌéòÏù¥ÏßÄ)",1),(c(!0),$(H,null,W(i.value,l=>(c(),_(R,{key:l.id,class:"mb-4",variant:"elevated",onClick:b=>t.$router.push(`/guest-board/${l.id}`),style:{cursor:"pointer"}},{default:o(()=>[u(E,null,{default:o(()=>{var b;return[d("div",ee,[d("div",null,[d("strong",null,f(l.nickname),1),d("span",te," | "+f(L(l.createdAt)),1)]),((b=k.value)==null?void 0:b.uid)===l.userId?(c(),_(n,{key:0,icon:"",color:"error",onClick:Y(se=>N(l),["stop"])},{default:o(()=>[u(I,null,{default:o(()=>e[3]||(e[3]=[m("mdi-delete")])),_:1})]),_:2},1032,["onClick"])):D("",!0)]),d("div",oe,f(l.message),1)]}),_:2},1024)]),_:2},1032,["onClick"]))),128)),y.value?(c(),$("div",ae,"Î™®Îì† Í∏ÄÏùÑ Î∂àÎü¨ÏôîÏäµÎãàÎã§.")):(c(),_(n,{key:1,onClick:S,loading:v.value,block:"",color:"secondary"},{default:o(()=>e[4]||(e[4]=[m(" Îçî Î≥¥Í∏∞ ")])),_:1},8,["loading"]))]),_:1})}}};export{ce as default};
